---
env:
  TZ: Europe/Paris
ingress:
  main:
    enabled: true
    annotations:
      traefik.ingress.kubernetes.io/router.middlewares: "{{ ( traefik_applicable_middleware + ['kube-operable-admin-auth@kubernetescrd'] ) | join(',') }}"
      external-dns.alpha.kubernetes.io/target: "{{ cloudflare_record_target }}"
      cert-manager.io/cluster-issuer: letsencrypt
      kubernetes.io/ingress.class: traefik
      traefik.ingress.kubernetes.io/router.entrypoints: websecure
    hosts:
    - host: "{{ portal_domain }}"
      paths:
        - path: "/"
          pathType: Prefix
    tls:
      - secretName: "{{ portal_domain }}-tls"
        hosts:
          - "{{ portal_domain }}"
configmap:
  config:
    enabled: true
    data:
      config.yml: |
        title: MBCaaS
        subtitle: Portal
        services:
          - name: Infrastructure
            logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/1c/ICloud_logo.svg/640px-ICloud_logo.svg.png"
            items: 
              - name: "Router"
                logo: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/1b/Traefik.logo.png/1200px-Traefik.logo.png"
                # Alternatively a fa icon can be provided:
                # icon: "fab fa-jenkins"
                subtitle: "Traefik"
                tag: "infra"
                url: "https://{{ traefik_dashboard_domain }}"
                target: "_blank" # optional html tag target attribute

              - name: "Monitoring"
                logo: "https://{{ grafana_domain }}/public/img/grafana_icon.svg"
                # Alternatively a fa icon can be provided:
                # icon: "fab fa-jenkins"
                subtitle: "Grafana"
                tag: "infra"
                url: "https://{{ grafana_domain }}"
                target: "_blank" # optional html tag target attribute

              - name: "Alerting"
                logo: "https://luktom.net/wordpress/wp-content/uploads/2019/05/prometheus.png"
                # Alternatively a fa icon can be provided:
                # icon: "fab fa-jenkins"
                subtitle: "alertmanager"
                tag: "infra"
                url: "https://{{ alertmanager_domain }}"
                target: "_blank" # optional html tag target attribute

              - name: "Request Debugger"
                icon: "fas fa-question"
                subtitle: "whoami"
                tag: "infra"
                url: "https://{{ request_debug_domain }}"
                target: "_blank" # optional html tag target attribute